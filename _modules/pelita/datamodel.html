<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pelita.datamodel &#8212; Pelita v0.2.0-379-g27302b0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'v0.2.0-379-g27302b0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Pelita v0.2.0-379-g27302b0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pelita.datamodel</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; The datamodel. &quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.containers</span> <span class="k">import</span> <span class="n">Mesh</span>
<span class="kn">from</span> <span class="nn">.graph</span> <span class="k">import</span> <span class="n">iter_adjacencies</span><span class="p">,</span> <span class="n">move_pos</span>
<span class="kn">from</span> <span class="nn">.layout</span> <span class="k">import</span> <span class="n">Layout</span>

<span class="n">north</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">south</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">west</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">east</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">stop</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="Team"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.Team">[docs]</a><span class="k">class</span> <span class="nc">Team</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; A team of bots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : int</span>
<span class="sd">        the index of the team within the Universe</span>
<span class="sd">    zone : tuple of int (x_min, x_max)</span>
<span class="sd">        the homezone of this team</span>
<span class="sd">    score : int, optional, default = 0</span>
<span class="sd">        the score of this team</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="n">zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span>

<div class="viewcode-block" id="Team.in_zone"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.Team.in_zone">[docs]</a>    <span class="k">def</span> <span class="nf">in_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a position is within the zone of this team.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : tuple of int (x, y)</span>
<span class="sd">            the position to check</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        is_in_zone : boolean</span>
<span class="sd">            True if the position is in the homezone and False otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Team(</span><span class="si">%i</span><span class="s1">, </span><span class="si">%s</span><span class="s1">, score=</span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__dict__</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_to_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="s2">&quot;zone&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span>
                <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_json_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># need to convert the json list to a tuple</span>
        <span class="n">item</span><span class="p">[</span><span class="s2">&quot;zone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;zone&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="Bot"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.Bot">[docs]</a><span class="k">class</span> <span class="nc">Bot</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; A bot on a team.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : int</span>
<span class="sd">        the index of this bot within the Universe</span>
<span class="sd">    initial_pos : tuple of int (x, y)</span>
<span class="sd">        the initial position for this bot</span>
<span class="sd">    team_index : int</span>
<span class="sd">        the index of the team that this bot is on</span>
<span class="sd">    homezone : tuple of int (x_min, x_max)</span>
<span class="sd">        the homezone of this team</span>
<span class="sd">    current_pos : tuple of int (x, y), optional</span>
<span class="sd">        the current position of this bot</span>
<span class="sd">        default = None (will be set to initial_pos)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    in_own_zone : boolean, property</span>
<span class="sd">        True if in its own homezone and False otherwise</span>
<span class="sd">    is_destroyer : boolean, property</span>
<span class="sd">        True if a destroyer, False otherwise</span>
<span class="sd">    is_harvester : boolean, property</span>
<span class="sd">        not is_destroyer</span>
<span class="sd">    noisy : boolean</span>
<span class="sd">        True if the position is noisy, False if it is exact</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">initial_pos</span><span class="p">,</span> <span class="n">team_index</span><span class="p">,</span> <span class="n">homezone</span><span class="p">,</span>
            <span class="n">current_pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noisy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span> <span class="o">=</span> <span class="n">initial_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">team_index</span> <span class="o">=</span> <span class="n">team_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">homezone</span> <span class="o">=</span> <span class="n">homezone</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_pos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span> <span class="o">=</span> <span class="n">current_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noisy</span> <span class="o">=</span> <span class="n">noisy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">in_own_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">homezone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">homezone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_destroyer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_own_zone</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_harvester</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_destroyer</span>

    <span class="k">def</span> <span class="nf">_to_initial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reset this bot to its initial position. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__dict__</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Bot(</span><span class="si">%i</span><span class="s1">, </span><span class="si">%s</span><span class="s1">, </span><span class="si">%i</span><span class="s1">, </span><span class="si">%s</span><span class="s1"> , current_pos=</span><span class="si">%s</span><span class="s1">, noisy=</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_index</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">homezone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noisy</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_to_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="s2">&quot;initial_pos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_pos</span><span class="p">,</span>
                <span class="s2">&quot;team_index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_index</span><span class="p">,</span>
                <span class="s2">&quot;homezone&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">homezone</span><span class="p">,</span>
                <span class="s2">&quot;current_pos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pos</span><span class="p">,</span>
                <span class="s2">&quot;noisy&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">noisy</span><span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_json_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># need to convert the json list to a tuple</span>
        <span class="k">for</span> <span class="n">tupled_attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;initial_pos&quot;</span><span class="p">,</span> <span class="s2">&quot;homezone&quot;</span><span class="p">,</span> <span class="s2">&quot;current_pos&quot;</span><span class="p">]:</span>
            <span class="n">item</span><span class="p">[</span><span class="n">tupled_attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">tupled_attr</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="o">**</span><span class="n">item</span><span class="p">)</span></div>

<span class="n">Free</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="n">Wall</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span>
<span class="n">Food</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>

<span class="n">maze_components</span> <span class="o">=</span> <span class="p">[</span><span class="n">Food</span><span class="p">,</span> <span class="n">Free</span><span class="p">,</span> <span class="n">Wall</span><span class="p">]</span>

<div class="viewcode-block" id="Maze"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.Maze">[docs]</a><span class="k">class</span> <span class="nc">Maze</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; The `Maze` object holds the walls of the universe.</span>

<span class="sd">    Data is stored and given in row-based order, eg.</span>

<span class="sd">    &gt;&gt;&gt; m = Maze(4, 3, data=[True, False, True, True] + [True, False, False, True] + 4*[True])</span>

<span class="sd">    specifies the maze</span>

<span class="sd">        # ##</span>
<span class="sd">        #  #</span>
<span class="sd">        ####</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width : int</span>
<span class="sd">        the width of the maze</span>
<span class="sd">    height : int</span>
<span class="sd">        the height of the maze</span>
<span class="sd">    data : iterable of bools</span>
<span class="sd">        the walls of the maze (True) or free space (False) in row-based order</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : (int, int)</span>
<span class="sd">        tuple of width and height</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Maze keyword argument &#39;data&#39; should be a list of of &quot;</span> <span class="o">+</span>\
                            <span class="s2">&quot;bools, not: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Maze</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The indices of positions in the Maze.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        positions : list of tuple of (int, int)</span>
<span class="sd">            the positions (x, y) in the Maze</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

<div class="viewcode-block" id="create_maze"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.create_maze">[docs]</a><span class="k">def</span> <span class="nf">create_maze</span><span class="p">(</span><span class="n">layout_mesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Transforms a layout_mesh into a Maze.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    layout_mesh : Mesh of single char strings</span>
<span class="sd">        Mesh of single character strings describing the layout</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    maze : Maze</span>
<span class="sd">        the Maze</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maze</span> <span class="o">=</span> <span class="n">Maze</span><span class="p">(</span><span class="n">layout_mesh</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">layout_mesh</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
    <span class="n">food</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">layout_mesh</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">Wall</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">maze</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Food</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">food</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">maze</span><span class="p">,</span> <span class="n">food</span></div>

<div class="viewcode-block" id="extract_initial_positions"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.extract_initial_positions">[docs]</a><span class="k">def</span> <span class="nf">extract_initial_positions</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">number_bots</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Extract initial positions from mesh.</span>

<span class="sd">    Also replaces the initial positions in the mesh with free spaces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesh : Mesh of characters</span>
<span class="sd">        the layout in mesh format</span>
<span class="sd">    number_bots : int</span>
<span class="sd">        the number of bots for which to find initial positions</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    initial pos : list of tuples</span>
<span class="sd">        the initial positions for all the bots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_bots</span><span class="p">)]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">number_bots</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">bot_ids</span><span class="p">:</span>
            <span class="n">start</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="n">mesh</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Free</span>
    <span class="k">return</span> <span class="n">start</span></div>


<div class="viewcode-block" id="UniverseException"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.UniverseException">[docs]</a><span class="k">class</span> <span class="nc">UniverseException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Standard error in the Universe. &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="IllegalMoveException"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.IllegalMoveException">[docs]</a><span class="k">class</span> <span class="nc">IllegalMoveException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Raised when a bot attempts to make an illegal move. &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="CTFUniverse"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse">[docs]</a><span class="k">class</span> <span class="nc">CTFUniverse</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The Universe: representation of the game state.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    maze : Maze object</span>
<span class="sd">        the maze</span>
<span class="sd">    teams : list of Team objects</span>
<span class="sd">        the teams</span>
<span class="sd">    bots : list of Bot objects</span>
<span class="sd">        the bots</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    bot_positions : list of tuple of ints (x, y), property</span>
<span class="sd">        the current position of all bots</span>
<span class="sd">    food_list : list of tuple of ints (x, y), property</span>
<span class="sd">        the positions of all edible food</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="CTFUniverse.create"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">layout_str</span><span class="p">,</span> <span class="n">number_bots</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Factory to create a 2 team Capture The Flag Universe.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        layout_str : str</span>
<span class="sd">            the string encoding the maze layout</span>
<span class="sd">        number_bots : int</span>
<span class="sd">            the number of bots in the game</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        UniverseException</span>
<span class="sd">            if the number of bots or layout width are odd</span>
<span class="sd">        LayoutEncodingException</span>
<span class="sd">            if there is something wrong with the layout_str, see `Layout()`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layout_chars</span> <span class="o">=</span> <span class="n">maze_components</span>

        <span class="k">if</span> <span class="n">number_bots</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UniverseException</span><span class="p">(</span>
                <span class="s2">&quot;Number of bots in CTF must be even, is: </span><span class="si">%i</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">number_bots</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">layout_str</span><span class="p">,</span> <span class="n">layout_chars</span><span class="p">,</span> <span class="n">number_bots</span><span class="p">)</span>
        <span class="n">layout_mesh</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">as_mesh</span><span class="p">()</span>
        <span class="n">initial_pos</span> <span class="o">=</span> <span class="n">extract_initial_positions</span><span class="p">(</span><span class="n">layout_mesh</span><span class="p">,</span> <span class="n">number_bots</span><span class="p">)</span>
        <span class="n">maze</span><span class="p">,</span> <span class="n">food</span> <span class="o">=</span> <span class="n">create_maze</span><span class="p">(</span><span class="n">layout_mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">maze</span><span class="o">.</span><span class="n">width</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UniverseException</span><span class="p">(</span>
                <span class="s2">&quot;Width of a layout for CTF must be even, is: </span><span class="si">%i</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">maze</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

        <span class="n">homezones</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="n">maze</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">teams</span> <span class="o">=</span> <span class="p">[</span><span class="n">Team</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">homezone</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">homezone</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">homezones</span><span class="p">)]</span>

        <span class="n">bots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">bot_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_bots</span><span class="p">):</span>
            <span class="n">team_index</span> <span class="o">=</span> <span class="n">bot_index</span> <span class="o">%</span> <span class="mi">2</span>
            <span class="n">bot</span> <span class="o">=</span> <span class="n">Bot</span><span class="p">(</span><span class="n">bot_index</span><span class="p">,</span> <span class="n">initial_pos</span><span class="p">[</span><span class="n">bot_index</span><span class="p">],</span>
                    <span class="n">team_index</span><span class="p">,</span> <span class="n">homezones</span><span class="p">[</span><span class="n">team_index</span><span class="p">])</span>
            <span class="n">bots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">maze</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">teams</span><span class="p">,</span> <span class="n">bots</span><span class="p">)</span></div>

    <span class="c1">#: All possible (but not necessarily legal) moves</span>
    <span class="n">_moves</span> <span class="o">=</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">stop</span><span class="p">]</span>

    <span class="c1">#: the number of points to score when killing</span>
    <span class="n">KILLPOINTS</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">teams</span><span class="p">,</span> <span class="n">bots</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maze</span> <span class="o">=</span> <span class="n">maze</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">food</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">teams</span> <span class="o">=</span> <span class="n">teams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bots</span> <span class="o">=</span> <span class="n">bots</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bot_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Current positions of all bots.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bot_positions : list of tuple of (int, int)</span>
<span class="sd">            the positions of all bots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">food_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Positions of all the food.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        food_positions : list of tuple of (int, int)</span>
<span class="sd">            the positions of all food</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">food</span>

<div class="viewcode-block" id="CTFUniverse.team_food"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.team_food">[docs]</a>    <span class="k">def</span> <span class="nf">team_food</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Food that is owned by a team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        team_food : list of tuple of (int, int)</span>
<span class="sd">            food owned by team</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_list</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team_index</span><span class="p">]</span><span class="o">.</span><span class="n">in_zone</span><span class="p">(</span><span class="n">pos</span><span class="p">)]</span></div>

<div class="viewcode-block" id="CTFUniverse.enemy_food"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.enemy_food">[docs]</a>    <span class="k">def</span> <span class="nf">enemy_food</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Food that is edible by a team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        team_food : list of tuple of (int, int)</span>
<span class="sd">            food edible by team</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_list</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team_index</span><span class="p">]</span><span class="o">.</span><span class="n">in_zone</span><span class="p">(</span><span class="n">pos</span><span class="p">)]</span></div>

<div class="viewcode-block" id="CTFUniverse.other_team_bots"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.other_team_bots">[docs]</a>    <span class="k">def</span> <span class="nf">other_team_bots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain other bots on team.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot_index : int</span>
<span class="sd">            index of the bot in question</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        other_team_bots : list of Bot objects</span>
<span class="sd">            the other bots on the team, excluding the desired bot</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">team_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">[</span><span class="n">bot_index</span><span class="p">]</span><span class="o">.</span><span class="n">team_index</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">bot</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_bots</span><span class="p">(</span><span class="n">team_index</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">bot</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">bot_index</span><span class="p">]</span></div>

<div class="viewcode-block" id="CTFUniverse.team_bots"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.team_bots">[docs]</a>    <span class="k">def</span> <span class="nf">team_bots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain all Bot objects in a Team.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        team_index : int</span>
<span class="sd">            the index of the desired team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        team_bots : list of Bot objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">bot</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span>
                <span class="k">if</span> <span class="n">bot</span><span class="o">.</span><span class="n">team_index</span> <span class="o">==</span> <span class="n">team_index</span><span class="p">]</span></div>

<div class="viewcode-block" id="CTFUniverse.enemy_bots"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.enemy_bots">[docs]</a>    <span class="k">def</span> <span class="nf">enemy_bots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain enemy bot objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        team_index : int</span>
<span class="sd">            the index of the &#39;friendly&#39; team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        enemy_bots : list of Bot objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">bot</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">bot</span><span class="o">.</span><span class="n">team_index</span> <span class="o">==</span> <span class="n">team_index</span><span class="p">]</span></div>

<div class="viewcode-block" id="CTFUniverse.enemy_team"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.enemy_team">[docs]</a>    <span class="k">def</span> <span class="nf">enemy_team</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain the enemy team.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        team_index : int</span>
<span class="sd">            the index of the &#39;friendly&#39; team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        enemy_team : Team object</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        UniverseException</span>
<span class="sd">            if there is more than one enemy team</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other_teams</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[:]</span>
        <span class="n">other_teams</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team_index</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_teams</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UniverseException</span><span class="p">(</span><span class="s2">&quot;Expecting one enemy team. Found </span><span class="si">%i</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_teams</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">other_teams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="CTFUniverse.team_border"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.team_border">[docs]</a>    <span class="k">def</span> <span class="nf">team_border</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">team_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Positions of the border positions.</span>

<span class="sd">        These are the last positions in the zone of the team.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        team_index : int</span>
<span class="sd">            the index of the &#39;friendly&#39; team</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        team_border : list of tuple of (int, int)</span>
<span class="sd">            the border positions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">team_zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">team_index</span><span class="p">]</span><span class="o">.</span><span class="n">zone</span>
        <span class="k">if</span> <span class="n">team_zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x_min</span><span class="p">:</span>
            <span class="n">border_x</span> <span class="o">=</span> <span class="n">team_zone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">border_x</span> <span class="o">=</span> <span class="n">team_zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">border_x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">[</span><span class="n">border_x</span><span class="p">,</span> <span class="n">y</span><span class="p">]]</span></div>

<div class="viewcode-block" id="CTFUniverse.move_bot"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.move_bot">[docs]</a>    <span class="k">def</span> <span class="nf">move_bot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bot_id</span><span class="p">,</span> <span class="n">move</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Move a bot in certain direction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot_id : int</span>
<span class="sd">            index of the bot</span>
<span class="sd">        move : tuple of (int, int)</span>
<span class="sd">            direction to move in</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        game_state : dict</span>
<span class="sd">            the current game_state</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        IllegalMoveException</span>
<span class="sd">            if the move is invalid or impossible</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check legality of the move</span>

        <span class="n">game_state</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">bot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">[</span><span class="n">bot_id</span><span class="p">]</span>
        <span class="n">legal_moves_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legal_moves</span><span class="p">(</span><span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">move</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal_moves_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">IllegalMoveException</span><span class="p">(</span>
                <span class="s1">&#39;Illegal move from bot_id </span><span class="si">%r</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bot_id</span><span class="p">,</span> <span class="n">move</span><span class="p">))</span>
        <span class="n">old_pos</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span> <span class="o">=</span> <span class="n">legal_moves_dict</span><span class="p">[</span><span class="n">move</span><span class="p">]</span>

        <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_moved&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;bot_id&quot;</span><span class="p">:</span> <span class="n">bot_id</span><span class="p">,</span> <span class="s2">&quot;old_pos&quot;</span><span class="p">:</span> <span class="n">old_pos</span><span class="p">,</span> <span class="s2">&quot;new_pos&quot;</span><span class="p">:</span> <span class="n">new_pos</span><span class="p">}]</span>

        <span class="n">team</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="n">bot</span><span class="o">.</span><span class="n">team_index</span><span class="p">]</span>
        <span class="c1"># check for food being eaten</span>
        <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;food_eaten&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_list</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">bot</span><span class="o">.</span><span class="n">in_own_zone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span><span class="p">)</span>

            <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;food_eaten&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;food_pos&quot;</span><span class="p">:</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span><span class="p">,</span> <span class="s2">&quot;bot_id&quot;</span><span class="p">:</span> <span class="n">bot_id</span><span class="p">}]</span>

        <span class="c1"># check for destruction</span>
        <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_destroyed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">enemy</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enemy_bots</span><span class="p">(</span><span class="n">bot</span><span class="o">.</span><span class="n">team_index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">current_pos</span> <span class="o">==</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">enemy</span><span class="o">.</span><span class="n">is_destroyer</span> <span class="ow">and</span> <span class="n">bot</span><span class="o">.</span><span class="n">is_harvester</span><span class="p">:</span>
                    <span class="n">destroyer</span> <span class="o">=</span> <span class="n">enemy</span><span class="o">.</span><span class="n">index</span>
                    <span class="n">harvester</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">index</span>
                <span class="k">elif</span> <span class="n">bot</span><span class="o">.</span><span class="n">is_destroyer</span> <span class="ow">and</span> <span class="n">enemy</span><span class="o">.</span><span class="n">is_harvester</span><span class="p">:</span>
                    <span class="n">destroyer</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">index</span>
                    <span class="n">harvester</span> <span class="o">=</span> <span class="n">enemy</span><span class="o">.</span><span class="n">index</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># move on, if harvester is already destroyed</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">bot_destr</span><span class="p">[</span><span class="s2">&quot;bot_id&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">harvester</span> <span class="k">for</span> <span class="n">bot_destr</span> <span class="ow">in</span> <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_destroyed&quot;</span><span class="p">]):</span>
                    <span class="k">continue</span>

                <span class="c1"># otherwise mark for destruction</span>
                <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_destroyed&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[{</span><span class="s1">&#39;bot_id&#39;</span><span class="p">:</span> <span class="n">harvester</span><span class="p">,</span> <span class="s1">&#39;destroyed_by&#39;</span><span class="p">:</span> <span class="n">destroyer</span><span class="p">}]</span>

        <span class="c1"># reset bots</span>
        <span class="k">for</span> <span class="n">destroyed</span> <span class="ow">in</span> <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_destroyed&quot;</span><span class="p">]:</span>
            <span class="n">old_pos</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">[</span><span class="n">destroyed</span><span class="p">[</span><span class="s2">&quot;bot_id&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">_to_initial</span><span class="p">()</span>
            <span class="n">new_pos</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span>
            <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_moved&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;bot_id&quot;</span><span class="p">:</span> <span class="n">bot_id</span><span class="p">,</span> <span class="s2">&quot;old_pos&quot;</span><span class="p">:</span> <span class="n">old_pos</span><span class="p">,</span> <span class="s2">&quot;new_pos&quot;</span><span class="p">:</span> <span class="n">new_pos</span><span class="p">}]</span>

        <span class="k">for</span> <span class="n">food_eaten</span> <span class="ow">in</span> <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;food_eaten&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">[</span><span class="n">food_eaten</span><span class="p">[</span><span class="s2">&quot;bot_id&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">team_index</span><span class="p">]</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">bot_destroyed</span> <span class="ow">in</span> <span class="n">game_state</span><span class="p">[</span><span class="s2">&quot;bot_destroyed&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">[</span><span class="n">bot_destroyed</span><span class="p">[</span><span class="s2">&quot;destroyed_by&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">team_index</span><span class="p">]</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KILLPOINTS</span>

        <span class="k">return</span> <span class="n">game_state</span></div>

        <span class="c1"># TODO:</span>
        <span class="c1"># check for state change</span>

<div class="viewcode-block" id="CTFUniverse.legal_moves"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.legal_moves">[docs]</a>    <span class="k">def</span> <span class="nf">legal_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain legal moves and where they lead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : tuple of int (x, y)</span>
<span class="sd">            the position to start at</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        legal_moves_dict : dict mapping strings (moves) to positions (x, y)</span>
<span class="sd">            the legal moves and where they would lead.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">legal_moves_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">move</span><span class="p">,</span> <span class="n">new_pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbourhood</span><span class="p">(</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">[</span><span class="n">new_pos</span><span class="p">]:</span>
                    <span class="n">legal_moves_dict</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_pos</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="c1"># If were outside the maze, it is not a legal move.</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">legal_moves_dict</span></div>

<div class="viewcode-block" id="CTFUniverse.legal_moves_or_stop"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.legal_moves_or_stop">[docs]</a>    <span class="k">def</span> <span class="nf">legal_moves_or_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Obtain legal moves (and where they lead)</span>
<span class="sd">        or just stop if impossible to move.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : tuple of int (x, y)</span>
<span class="sd">            the position to start at</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        legal_moves : dict mapping strings (moves) to positions (x, y)</span>
<span class="sd">            the legal moves and where they would lead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legal_moves</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">moves</span><span class="p">[</span><span class="n">stop</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">moves</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;CTFUniverse(</span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">, </span><span class="si">%r</span><span class="s2">)&quot;</span> <span class="o">%</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">__dict__</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_char_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">char_mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">positions</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
                <span class="n">char_mesh</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">Wall</span>
            <span class="k">elif</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">food</span><span class="p">:</span>
                <span class="n">char_mesh</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">Food</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">char_mesh</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">Free</span>
        <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">:</span>
            <span class="c1"># TODO what about bots on the same space?</span>
            <span class="n">char_mesh</span><span class="p">[</span><span class="n">bot</span><span class="o">.</span><span class="n">current_pos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bot</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">char_mesh</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_char_mesh</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_json_dict</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">compact_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_char_mesh</span><span class="o">.</span><span class="n">compact_str</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Provide detailed, readable info about universe state.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pretty : str</span>
<span class="sd">            detailed, readable string version of this universe</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; universe.pretty</span>
<span class="sd">        ##################</span>
<span class="sd">        #0#.  .  # .     #</span>
<span class="sd">        #1#####    #####2#</span>
<span class="sd">        #     . #  .  .#3#</span>
<span class="sd">        ##################</span>
<span class="sd">        Team(0, (0, 8), score=0)</span>
<span class="sd">            Bot(0, (1, 1), 0, (0, 8) , current_pos=(1, 1))</span>
<span class="sd">            Bot(2, (16, 2), 0, (0, 8) , current_pos=(16, 2))</span>
<span class="sd">        Team(1, (9, 17), score=0)</span>
<span class="sd">            Bot(1, (1, 2), 1, (9, 17) , current_pos=(1, 2))</span>
<span class="sd">            Bot(3, (16, 3), 1, (9, 17) , current_pos=(16, 3))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compact_str</span>
        <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">team</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">team_bots</span><span class="p">(</span><span class="n">team</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">out</span>

<div class="viewcode-block" id="CTFUniverse.neighbourhood"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.neighbourhood">[docs]</a>    <span class="k">def</span> <span class="nf">neighbourhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Determine where a move will lead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : tuple of int (x, y)</span>
<span class="sd">            current position</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_pos : dict</span>
<span class="sd">            mapping of moves to new positions (x, y)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">iter_pos</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_moves</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">move_pos</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">move</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">move</span><span class="p">,</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">iter_pos</span><span class="p">())</span></div>

<div class="viewcode-block" id="CTFUniverse.reachable"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.reachable">[docs]</a>    <span class="k">def</span> <span class="nf">reachable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_positions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns all reachable positions starting from a list initial positions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        initial_positions : list(pos)</span>
<span class="sd">            list of initial positions</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        adjacency_list : generator of (pos, list(pos))</span>
<span class="sd">            Generator which contains all reachable positions and their adjacencies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">it</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">iter_adjacencies</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">legal_moves</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span></div>

<div class="viewcode-block" id="CTFUniverse.free_positions"><a class="viewcode-back" href="../../pelita/pelita.datamodel.html#pelita.datamodel.CTFUniverse.free_positions">[docs]</a>    <span class="k">def</span> <span class="nf">free_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns an adjacency list for all Free positions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        adjacency_list : generator of (pos, list(pos))</span>
<span class="sd">            Generator which contains all reachable positions and their adjacencies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the list of all free positions.</span>
        <span class="n">free_pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">]</span>

        <span class="c1"># Here we use a generator on a dictionary to create the adjacency list.</span>
        <span class="c1"># However, for Python 3, we force evaluation on the legal_moves.values</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legal_moves</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_to_json_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;maze&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="o">.</span><span class="n">_to_json_dict</span><span class="p">(),</span>
                <span class="s2">&quot;food&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">food</span><span class="p">),</span>
                <span class="s2">&quot;teams&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">team</span><span class="o">.</span><span class="n">_to_json_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="p">],</span>
                <span class="s2">&quot;bots&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">bot</span><span class="o">.</span><span class="n">_to_json_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bots</span><span class="p">]}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_json_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">maze</span><span class="o">=</span><span class="n">Maze</span><span class="o">.</span><span class="n">_from_json_dict</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;maze&quot;</span><span class="p">]),</span>
                   <span class="n">food</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;food&quot;</span><span class="p">],</span>
                   <span class="n">teams</span><span class="o">=</span><span class="p">[</span><span class="n">Team</span><span class="o">.</span><span class="n">_from_json_dict</span><span class="p">(</span><span class="n">team</span><span class="p">)</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;teams&quot;</span><span class="p">]],</span>
                   <span class="n">bots</span><span class="o">=</span><span class="p">[</span><span class="n">Bot</span><span class="o">.</span><span class="n">_from_json_dict</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span> <span class="k">for</span> <span class="n">bot</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;bots&quot;</span><span class="p">]])</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Pelita</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ASPP&repo=pelita&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../info.html">Project Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing_player.html">Writing a Player</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../running_player.html">Running Players</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-api.html">User API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;20112015, Valentin Haenel, Rike-Benjamin Schuppner et. al..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>